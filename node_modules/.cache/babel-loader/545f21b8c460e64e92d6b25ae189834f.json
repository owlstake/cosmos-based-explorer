{"ast":null,"code":"import \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { BCard, BCardTitle, BCardFooter, BButton, BProgressBar, BProgress, BBadge, BTooltip, BRow, BCol, VBModal } from 'bootstrap-vue';\nimport Ripple from 'vue-ripple-directive';\nimport { percent as _percent, tokenFormatter } from '@/libs/utils';\nimport dayjs from 'dayjs';\nimport OperationModal from '@/views/components/OperationModal/index.vue';\nexport default {\n  components: {\n    BCard: BCard,\n    BButton: BButton,\n    BCardFooter: BCardFooter,\n    BProgressBar: BProgressBar,\n    BProgress: BProgress,\n    BBadge: BBadge,\n    BCardTitle: BCardTitle,\n    BTooltip: BTooltip,\n    BRow: BRow,\n    BCol: BCol,\n    OperationModal: OperationModal\n  },\n  directives: {\n    'b-modal': VBModal,\n    Ripple: Ripple\n  },\n  data: function data() {\n    return {\n      selectedProposalId: 0,\n      selectedTitle: '',\n      proposals: [],\n      max: 1,\n      operationModalType: '',\n      next: ''\n    };\n  },\n  mounted: function mounted() {\n    this.getList();\n  },\n  methods: {\n    formatType: function formatType(v) {\n      var txt = String(v).replace('Proposal', '');\n      var index = txt.lastIndexOf('.');\n      return index > 0 ? txt.substring(index + 1) : txt;\n    },\n    percent: function percent(v) {\n      return _percent(v);\n    },\n    formatDate: function formatDate(v) {\n      return dayjs(v).format('YYYY-MM-DD');\n    },\n    formatToken: function formatToken(v) {\n      return tokenFormatter(v, {});\n    },\n    selectProposal: function selectProposal(modal, pid, title) {\n      this.operationModalType = modal;\n      this.selectedProposalId = Number(pid);\n      this.selectedTitle = title;\n    },\n    getList: function getList() {\n      var _this = this;\n\n      this.loading = true;\n      this.$http.getGovernanceList(this.next).then(function (res) {\n        _this.proposals = _this.proposals.concat(res.proposals);\n\n        _this.updateTally(_this.proposals);\n\n        _this.next = res.pagination.next_key;\n        _this.loading = false;\n      });\n    },\n    updateTally: function updateTally(res) {\n      var _this2 = this;\n\n      var voting = res.filter(function (i) {\n        return i.status === 2;\n      });\n\n      if (voting.length > 0) {\n        voting.forEach(function (p) {\n          return _this2.$http.getGovernanceTally(p.id, 0).then(function (update) {\n            _this2.$set(p, 'tally', update);\n          });\n        });\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqMA,SACAA,KADA,EACAC,UADA,EACAC,WADA,EACAC,OADA,EACAC,YADA,EACAC,SADA,EACAC,MADA,EACAC,QADA,EACAC,IADA,EACAC,IADA,EACAC,OADA,QAEA,eAFA;AAGA;AACA;AACA;AACA;AAEA;EACAC;IACAX,YADA;IAEAG,gBAFA;IAGAD,wBAHA;IAIAE,0BAJA;IAKAC,oBALA;IAMAC,cANA;IAOAL,sBAPA;IAQAM,kBARA;IASAC,UATA;IAUAC,UAVA;IAWAG;EAXA,CADA;EAcAC;IACA,kBADA;IAEAC;EAFA,CAdA;EAkBAC,IAlBA,kBAkBA;IACA;MACAC,qBADA;MAEAC,iBAFA;MAGAC,aAHA;MAIAC,MAJA;MAKAC,sBALA;MAMAC;IANA;EAQA,CA3BA;EA4BAC,OA5BA,qBA4BA;IACA;EACA,CA9BA;EA+BAC;IACAC,UADA,sBACAC,CADA,EACA;MACA;MACA;MACA;IACA,CALA;IAMAC;MAAA;IAAA,CANA;IAOAC;MAAA;IAAA,CAPA;IAQAC;MAAA;IAAA,CARA;IASAC,cATA,0BASAC,KATA,EASAC,GATA,EASAC,KATA,EASA;MACA;MACA;MACA;IACA,CAbA;IAcAC,OAdA,qBAcA;MAAA;;MACA;MACA;QACA;;QACA;;QACA;QACA;MACA,CALA;IAMA,CAtBA;IAuBAC,WAvBA,uBAuBAC,GAvBA,EAuBA;MAAA;;MACA;QAAA;MAAA;;MACA;QACAC;UAAA;YACA;UACA,CAFA;QAAA;MAGA;IACA;EA9BA;AA/BA","names":["BCard","BCardTitle","BCardFooter","BButton","BProgressBar","BProgress","BBadge","BTooltip","BRow","BCol","VBModal","components","OperationModal","directives","Ripple","data","selectedProposalId","selectedTitle","proposals","max","operationModalType","next","mounted","methods","formatType","v","percent","formatDate","formatToken","selectProposal","modal","pid","title","getList","updateTally","res","voting"],"sourceRoot":"src/views","sources":["Governance.vue"],"sourcesContent":["<template>\n  <div>\n    <b-row class=\"match-height\">\n      <b-col\n        v-for=\"p in proposals\"\n        :key=\"p.id\"\n        lg=\"6\"\n        md=\"12\"\n      >\n        <b-card>\n          <b-card-title class=\"mb-0\">\n            #{{ p.id }}.\n            <b-badge\n              v-if=\"p.status == 1\"\n              pill\n              variant=\"light-info\"\n              class=\"text-right\"\n            >\n              Deposit\n            </b-badge>\n            <b-badge\n              v-if=\"p.status == 2\"\n              pill\n              variant=\"light-primary\"\n              class=\"text-right\"\n            >\n              Voting\n            </b-badge>\n            <b-badge\n              v-if=\"p.status == 3\"\n              pill\n              variant=\"light-success\"\n              class=\"text-right\"\n            >\n              Passed\n            </b-badge>\n            <b-badge\n              v-if=\"p.status == 4\"\n              pill\n              variant=\"light-danger\"\n              class=\"text-right\"\n            >\n              Rejected\n            </b-badge>\n            <router-link\n              :to=\"`./gov/${p.id}`\"\n            >\n              {{ p.title }}\n            </router-link>\n          </b-card-title>\n          <div class=\"gov-wrapper flex-wrap my-1\">\n            <div class=\"gov\">\n              <p class=\"card-text mb-25\">\n                Type\n              </p>\n              <h6 class=\"mb-0\">\n                {{ formatType(p.contents['@type']) }}\n              </h6>\n            </div>\n            <div class=\"gov\">\n              <p class=\"card-text mb-25\">\n                Start Date\n              </p>\n              <h6 class=\"mb-0\">\n                {{ formatDate(p.voting_start_time) }}\n              </h6>\n            </div>\n            <div class=\"gov\">\n              <p class=\"card-text mb-25\">\n                End Date\n              </p>\n              <h6 class=\"mb-0\">\n                {{ formatDate(p.voting_end_time) }}\n              </h6>\n            </div>\n            <div class=\"gov\">\n              <p class=\"card-text mb-25\">\n                Deposit\n              </p>\n              <h6 class=\"mb-0\">\n                {{ formatToken(p.total_deposit) || '-' }}\n              </h6>\n            </div>\n          </div>\n\n          <b-progress\n            :max=\"100\"\n            height=\"2rem\"\n            class=\"mb-2\"\n            show-progress\n          >\n            <b-progress-bar\n              :id=\"'vote-yes'+p.id\"\n              variant=\"success\"\n              :value=\"percent(p.tally.yes)\"\n              show-progress\n              :label=\"`${percent(p.tally.yes).toFixed()}%`\"\n            />\n            <b-progress-bar\n              :id=\"'vote-no'+p.id\"\n              variant=\"warning\"\n              :value=\"percent(p.tally.no)\"\n              :label=\"`${percent(p.tally.no).toFixed()}%`\"\n              show-progress\n            />\n            <b-progress-bar\n              :id=\"'vote-veto'+p.id\"\n              variant=\"danger\"\n              :value=\"percent(p.tally.veto)\"\n              :label=\"`${percent(p.tally.veto).toFixed()}%`\"\n              show-progress\n            />\n            <b-progress-bar\n              :id=\"'vote-abstain'+p.id\"\n              variant=\"info\"\n              :value=\"percent(p.tally.abstain)\"\n              :label=\"`${percent(p.tally.abstain).toFixed()}%`\"\n              show-progress\n            />\n          </b-progress>\n          <b-tooltip\n            :target=\"'vote-yes'+p.id\"\n          >\n            {{ percent(p.tally.yes) }}% voted Yes\n          </b-tooltip>\n          <b-tooltip\n            :target=\"'vote-no'+p.id\"\n          >\n            {{ percent(p.tally.no) }}% voted No\n          </b-tooltip>\n          <b-tooltip\n            :target=\"'vote-veto'+p.id\"\n          >\n            {{ percent(p.tally.veto) }}% voted No With Veto\n          </b-tooltip>\n          <b-tooltip\n            :target=\"'vote-abstain'+p.id\"\n          >\n            {{ percent(p.tally.abstain) }}% voted Abstain\n          </b-tooltip>\n          <b-card-footer class=\"pb-0\">\n            <router-link\n              v-ripple.400=\"'rgba(113, 102, 240, 0.15)'\"\n              :to=\"`./gov/${p.id}`\"\n              variant=\"outline-primary\"\n            >\n              <b-button\n                v-ripple.400=\"'rgba(113, 102, 240, 0.15)'\"\n                :href=\"`./gov/${p.id}`\"\n                variant=\"outline-primary\"\n              >\n                {{ $t('btn_detail') }}\n              </b-button>\n            </router-link>\n            <b-button\n              v-if=\"p.status===1\"\n              v-b-modal.operation-modal\n              variant=\"primary\"\n              class=\"btn float-right mg-2\"\n              @click=\"selectProposal('GovDeposit',p.id, p.title)\"\n            >\n              {{ $t('btn_deposit') }}\n            </b-button>\n            <b-button\n              v-if=\"p.status===2\"\n              v-b-modal.operation-modal\n              variant=\"primary\"\n              class=\"btn float-right mg-2\"\n              @click=\"selectProposal('Vote',p.id, p.title)\"\n            >\n              {{ $t('btn_vote') }}\n            </b-button>\n          </b-card-footer>\n        </b-card>\n      </b-col>\n    </b-row>\n    <b-row v-if=\"next\">\n      <b-col>\n        <b-button\n          block\n          variant=\"outline-primary\"\n          :disabled=\"loading\"\n          @click=\"getList()\"\n        >\n          Load More\n        </b-button>\n      </b-col>\n    </b-row>\n    <operation-modal\n      :type=\"operationModalType\"\n      :proposal-id=\"selectedProposalId\"\n      :proposal-title=\"selectedTitle\"\n    />\n  </div>\n</template>\n\n<script>\nimport {\n  BCard, BCardTitle, BCardFooter, BButton, BProgressBar, BProgress, BBadge, BTooltip, BRow, BCol, VBModal,\n} from 'bootstrap-vue'\nimport Ripple from 'vue-ripple-directive'\nimport { percent, tokenFormatter } from '@/libs/utils'\nimport dayjs from 'dayjs'\nimport OperationModal from '@/views/components/OperationModal/index.vue'\n\nexport default {\n  components: {\n    BCard,\n    BButton,\n    BCardFooter,\n    BProgressBar,\n    BProgress,\n    BBadge,\n    BCardTitle,\n    BTooltip,\n    BRow,\n    BCol,\n    OperationModal,\n  },\n  directives: {\n    'b-modal': VBModal,\n    Ripple,\n  },\n  data() {\n    return {\n      selectedProposalId: 0,\n      selectedTitle: '',\n      proposals: [],\n      max: 1,\n      operationModalType: '',\n      next: '',\n    }\n  },\n  mounted() {\n    this.getList()\n  },\n  methods: {\n    formatType(v) {\n      const txt = String(v).replace('Proposal', '')\n      const index = txt.lastIndexOf('.')\n      return index > 0 ? txt.substring(index + 1) : txt\n    },\n    percent: v => percent(v),\n    formatDate: v => dayjs(v).format('YYYY-MM-DD'),\n    formatToken: v => tokenFormatter(v, {}),\n    selectProposal(modal, pid, title) {\n      this.operationModalType = modal\n      this.selectedProposalId = Number(pid)\n      this.selectedTitle = title\n    },\n    getList() {\n      this.loading = true\n      this.$http.getGovernanceList(this.next).then(res => {\n        this.proposals = this.proposals.concat(res.proposals)\n        this.updateTally(this.proposals)\n        this.next = res.pagination.next_key\n        this.loading = false\n      })\n    },\n    updateTally(res) {\n      const voting = res.filter(i => i.status === 2)\n      if (voting.length > 0) {\n        voting.forEach(p => this.$http.getGovernanceTally(p.id, 0).then(update => {\n          this.$set(p, 'tally', update)\n        }))\n      }\n    },\n  },\n}\n</script>\n\n<style scoped>\nsection {\n  display: flex;\n  /* flex-wrap: nowrap; */\n  justify-content: space-between;\n}\n.card {\n  flex-basis: 49%;\n}\n.gov-wrapper {\n    display: flex;\n    justify-content:center;\n}\n.dark-layout .gov-wrapper .gov {\n    background-color: #161d31;\n}\n.gov-wrapper .gov {\n    padding: .5rem;\n    margin: .3rem;\n    min-width: 7.5rem;\n    text-align: center;\n    background-color: #f8f8f8;\n    border-radius: .357rem;\n}\n\n</style>\n"]},"metadata":{},"sourceType":"module"}