{"ast":null,"code":"import _asyncToGenerator from \"/root/cosmos-based-explorer/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"/root/cosmos-based-explorer/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.split.js\";\n\n/*\n * @Description: file\n * @Autor: dingyiming\n * @Date: 2021-11-20 15:26:27\n * @LastEditors: dingyiming\n * @LastEditTime: 2021-11-20 15:33:07\n */\nimport { isTestnet } from '@/libs/utils';\nimport { sha256 } from '@cosmjs/crypto';\nimport { toHex } from '@cosmjs/encoding';\nvar chains = {};\n\nvar configs = require.context('../../chains/mainnet', false, /\\.json$/);\n\nif (isTestnet()) {\n  configs = require.context('../../chains/testnet', false, /\\.json$/);\n}\n\nvar update = {};\nconfigs.keys().forEach(function (k) {\n  var c = configs(k);\n  update[c.chain_name] = c;\n});\nchains = update;\nlocalStorage.setItem('chains', JSON.stringify(update));\nvar selected = chains.cosmos;\nvar avatarcache = localStorage.getItem('avatars');\nexport default {\n  namespaced: true,\n  state: {\n    config: chains,\n    selected: selected,\n    avatars: avatarcache ? JSON.parse(avatarcache) : {},\n    height: 0,\n    ibcChannels: {},\n    quotes: {},\n    defaultWallet: localStorage.getItem('default-wallet'),\n    denoms: {},\n    ibcPaths: {}\n  },\n  getters: {\n    getchains: function getchains(state) {\n      return state.chains;\n    },\n    getAvatarById: function getAvatarById(state) {\n      return function (id) {\n        return state.avatars[id];\n      };\n    }\n  },\n  mutations: {\n    setup_sdk_version: function setup_sdk_version(state, info) {\n      state.chains.config[info.chain_name].sdk_version = info.version;\n    },\n    select: function select(state, args) {\n      state.chains.selected = state.chains.config[args.chain_name];\n    },\n    cacheAvatar: function cacheAvatar(state, args) {\n      state.chains.avatars[args.identity] = args.url;\n      localStorage.setItem('avatars', JSON.stringify(state.chains.avatars));\n    },\n    setHeight: function setHeight(state, height) {\n      state.chains.height = height;\n    },\n    setChannels: function setChannels(state, _ref) {\n      var chain = _ref.chain,\n          channels = _ref.channels;\n      state.chains.ibcChannels[chain] = channels;\n    },\n    setQuotes: function setQuotes(state, quotes) {\n      state.quotes = quotes;\n    },\n    setDefaultWallet: function setDefaultWallet(state, defaultWallet) {\n      if (defaultWallet && defaultWallet.length > 0) {\n        localStorage.setItem('default-wallet', defaultWallet);\n        state.chains.defaultWallet = defaultWallet;\n      }\n    },\n    setIBCDenoms: function setIBCDenoms(state, denoms) {\n      state.denoms = _objectSpread(_objectSpread({}, state.denoms), denoms);\n    },\n    setIBCPaths: function setIBCPaths(state, paths) {\n      state.ibcPaths = paths;\n    }\n  },\n  actions: {\n    getQuotes: function getQuotes() {\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    },\n    getAllIBCDenoms: function getAllIBCDenoms(context, _this) {\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this.$http.getAllIBCDenoms().then(function (x) {\n                  var denomsMap = {};\n                  var pathsMap = {};\n                  x.denom_traces.forEach(function (trace) {\n                    var hash = toHex(sha256(new TextEncoder().encode(\"\".concat(trace.path, \"/\").concat(trace.base_denom))));\n                    var ibcDenom = \"ibc/\".concat(hash.toUpperCase());\n                    denomsMap[ibcDenom] = trace.base_denom;\n                    var path = trace.path.split('/');\n\n                    if (path.length >= 2) {\n                      pathsMap[ibcDenom] = {\n                        channel_id: path[path.length - 1],\n                        port_id: path[path.length - 2]\n                      };\n                    }\n                  });\n                  context.commit('setIBCDenoms', denomsMap);\n                  context.commit('setIBCPaths', pathsMap);\n                });\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["isTestnet","sha256","toHex","chains","configs","require","context","update","keys","forEach","k","c","chain_name","localStorage","setItem","JSON","stringify","selected","cosmos","avatarcache","getItem","namespaced","state","config","avatars","parse","height","ibcChannels","quotes","defaultWallet","denoms","ibcPaths","getters","getchains","getAvatarById","id","mutations","setup_sdk_version","info","sdk_version","version","select","args","cacheAvatar","identity","url","setHeight","setChannels","chain","channels","setQuotes","setDefaultWallet","length","setIBCDenoms","setIBCPaths","paths","actions","getQuotes","getAllIBCDenoms","_this","$http","then","x","denomsMap","pathsMap","denom_traces","trace","hash","TextEncoder","encode","path","base_denom","ibcDenom","toUpperCase","split","channel_id","port_id","commit"],"sources":["/root/cosmos-based-explorer/src/store/chains/index.js"],"sourcesContent":["/*\n * @Description: file\n * @Autor: dingyiming\n * @Date: 2021-11-20 15:26:27\n * @LastEditors: dingyiming\n * @LastEditTime: 2021-11-20 15:33:07\n */\nimport { isTestnet } from '@/libs/utils'\nimport { sha256 } from '@cosmjs/crypto'\nimport { toHex } from '@cosmjs/encoding'\n\nlet chains = {}\n\nlet configs = require.context('../../chains/mainnet', false, /\\.json$/)\nif (isTestnet()) {\n  configs = require.context('../../chains/testnet', false, /\\.json$/)\n}\n\nconst update = {}\nconfigs.keys().forEach(k => {\n  const c = configs(k)\n  update[c.chain_name] = c\n})\n\nchains = update\nlocalStorage.setItem('chains', JSON.stringify(update))\nconst selected = chains.cosmos\n\nconst avatarcache = localStorage.getItem('avatars')\n\nexport default {\n  namespaced: true,\n  state: {\n    config: chains,\n    selected,\n    avatars: avatarcache ? JSON.parse(avatarcache) : {},\n    height: 0,\n    ibcChannels: {},\n    quotes: {},\n    defaultWallet: localStorage.getItem('default-wallet'),\n    denoms: {},\n    ibcPaths: {},\n  },\n  getters: {\n    getchains: state => state.chains,\n    getAvatarById: state => id => state.avatars[id],\n  },\n  mutations: {\n    setup_sdk_version(state, info) {\n      state.chains.config[info.chain_name].sdk_version = info.version\n    },\n    select(state, args) {\n      state.chains.selected = state.chains.config[args.chain_name]\n    },\n    cacheAvatar(state, args) {\n      state.chains.avatars[args.identity] = args.url\n      localStorage.setItem('avatars', JSON.stringify(state.chains.avatars))\n    },\n    setHeight(state, height) {\n      state.chains.height = height\n    },\n    setChannels(state, { chain, channels }) {\n      state.chains.ibcChannels[chain] = channels\n    },\n    setQuotes(state, quotes) {\n      state.quotes = quotes\n    },\n    setDefaultWallet(state, defaultWallet) {\n      if (defaultWallet && defaultWallet.length > 0) {\n        localStorage.setItem('default-wallet', defaultWallet)\n        state.chains.defaultWallet = defaultWallet\n      }\n    },\n    setIBCDenoms(state, denoms) {\n      state.denoms = { ...state.denoms, ...denoms }\n    },\n    setIBCPaths(state, paths) {\n      state.ibcPaths = paths\n    },\n  },\n  actions: {\n    async getQuotes() {},\n\n    async getAllIBCDenoms(context, _this) {\n      _this.$http.getAllIBCDenoms().then(x => {\n        const denomsMap = {}\n        const pathsMap = {}\n        x.denom_traces.forEach(trace => {\n          const hash = toHex(sha256(new TextEncoder().encode(`${trace.path}/${trace.base_denom}`)))\n          const ibcDenom = `ibc/${hash.toUpperCase()}`\n          denomsMap[ibcDenom] = trace.base_denom\n\n          const path = trace.path.split('/')\n          if (path.length >= 2) {\n            pathsMap[ibcDenom] = {\n              channel_id: path[path.length - 1],\n              port_id: path[path.length - 2],\n            }\n          }\n        })\n        context.commit('setIBCDenoms', denomsMap)\n        context.commit('setIBCPaths', pathsMap)\n      })\n    },\n  },\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}