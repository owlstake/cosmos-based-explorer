{"ast":null,"code":"import \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { BCard, BCardTitle, BCardFooter, BButton, BProgressBar, BProgress, BBadge, BTooltip, BRow, BCol, VBModal } from 'bootstrap-vue';\nimport Ripple from 'vue-ripple-directive';\nimport { percent as _percent, tokenFormatter } from '@/libs/utils';\nimport dayjs from 'dayjs';\nimport OperationModal from '@/views/components/OperationModal/index.vue';\nexport default {\n  components: {\n    BCard: BCard,\n    BButton: BButton,\n    BCardFooter: BCardFooter,\n    BProgressBar: BProgressBar,\n    BProgress: BProgress,\n    BBadge: BBadge,\n    BCardTitle: BCardTitle,\n    BTooltip: BTooltip,\n    BRow: BRow,\n    BCol: BCol,\n    OperationModal: OperationModal\n  },\n  directives: {\n    'b-modal': VBModal,\n    Ripple: Ripple\n  },\n  data: function data() {\n    return {\n      selectedProposalId: 0,\n      selectedTitle: '',\n      proposals: [],\n      max: 1,\n      operationModalType: '',\n      next: ''\n    };\n  },\n  mounted: function mounted() {\n    this.getList();\n  },\n  methods: {\n    formatType: function formatType(v) {\n      var txt = String(v).replace('Proposal', '');\n      var index = txt.lastIndexOf('.');\n      return index > 0 ? txt.substring(index + 1) : txt;\n    },\n    percent: function percent(v) {\n      return _percent(v);\n    },\n    formatDate: function formatDate(v) {\n      return dayjs(v).format('YYYY-MM-DD');\n    },\n    formatToken: function formatToken(v) {\n      return tokenFormatter(v, {});\n    },\n    selectProposal: function selectProposal(modal, pid, title) {\n      this.operationModalType = modal;\n      this.selectedProposalId = Number(pid);\n      this.selectedTitle = title;\n    },\n    getList: function getList() {\n      var _this = this;\n\n      this.loading = true;\n      this.$http.getGovernanceList(this.next).then(function (res) {\n        _this.proposals = _this.proposals.concat(res.proposals);\n\n        _this.updateTally(_this.proposals);\n\n        _this.next = res.pagination.next_key;\n        _this.loading = false;\n      });\n    },\n    updateTally: function updateTally(res) {\n      var _this2 = this;\n\n      var voting = res.filter(function (i) {\n        return i.status === 2;\n      });\n\n      if (voting.length > 0) {\n        voting.forEach(function (p) {\n          return _this2.$http.getGovernanceTally(p.id, 0).then(function (update) {\n            _this2.$set(p, 'tally', update);\n          });\n        });\n      }\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}